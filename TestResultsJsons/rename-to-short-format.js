#!/usr/bin/env node
const fs=require("fs"),path=require("path"),reportsDir=__dirname;function parseTimestamp(e){const n=e.match(/(\d{4})-(\d{2})-(\d{2})T(\d{2})-(\d{2})-(\d{2})-\d{3}Z/);if(n){const[,e,o,r,t,s,a]=n;return{year:e,month:o,day:r,hour:t,minute:s,second:a}}return null}function generateShortName(e){const{year:n,month:o,day:r,hour:t,minute:s,second:a}=e;return`gct-${n}${o}${r}-${t}${s}${a}.json`}function renameReports(){const e=fs.readdirSync(reportsDir).filter(e=>e.endsWith(".json")&&"index.json"!==e&&"stats.json"!==e&&!e.startsWith("gct-"));console.log(`\nðŸ“ Found ${e.length} files to rename\n`);let n=0,o=0;const r=[];if(e.forEach(e=>{const t=parseTimestamp(e);if(!t)return console.log(`âš ï¸  Skipped: ${e} (no timestamp found)`),void o++;const s=generateShortName(t),a=path.join(reportsDir,e),i=path.join(reportsDir,s);if(fs.existsSync(i))return console.log(`âš ï¸  Skipped: ${e} (${s} already exists)`),void o++;try{fs.renameSync(a,i),console.log(`âœ… ${e}`),console.log(`   â†’ ${s}\n`),n++,r.push({old:e,new:s})}catch(l){console.error(`âŒ Failed to rename ${e}: ${l.message}`),o++}}),console.log(`\n${"=".repeat(60)}`),console.log("ðŸ“Š Summary:"),console.log(`   âœ… Renamed: ${n} files`),console.log(`   âš ï¸  Skipped: ${o} files`),console.log(`${"=".repeat(60)}\n`),r.length>0){const e=path.join(reportsDir,".rename-log.json"),n=fs.existsSync(e)?JSON.parse(fs.readFileSync(e,"utf8")):[],o={timestamp:(new Date).toISOString(),renames:r};n.push(o),fs.writeFileSync(e,JSON.stringify(n,null,2)),console.log("ðŸ“ Rename log saved to .rename-log.json\n")}return{renamed:n,skipped:o}}if(require.main===module){console.log("\nðŸ”„ Starting Report Rename Process...\n");const e=renameReports();e.renamed>0&&(console.log("âœ¨ Done! Remember to regenerate the index:"),console.log("   node generate-index-enhanced.js\n"))}module.exports={renameReports,parseTimestamp,generateShortName};